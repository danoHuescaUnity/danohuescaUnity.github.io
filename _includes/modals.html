{% for post in site.posts %}
<div class="portfolio-modal modal fade" id="portfolioModal-{{ post.modal-id }}" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-content">
    <div class="close-modal" data-dismiss="modal" aria-label="Close modal">
      <div class="lr">
        <div class="rl"></div>
      </div>
    </div>

    <div class="container">
      <div class="row">
        <div class="col-lg-8 col-lg-offset-2">
          <div class="modal-body">

            <h2>{{ post.title }}</h2>
            <hr class="star-primary">

            {%- comment -%}
              Media selection order:
              1) video_modal
              2) video
              3) video_thumb
              Otherwise show image (img/portfolio/{post.img})

              Video fields can be:
              - Full URL: https://...
              - Site-root path: /video/my.mp4
              - Filename only: my.mp4 (resolved under /video/)
            {%- endcomment -%}

            {% assign media_video = "" %}

            {% if post.video_modal %}
              {% assign media_video = post.video_modal %}
            {% elsif post.video %}
              {% assign media_video = post.video %}
            {% elsif post.video_thumb %}
              {% assign media_video = post.video_thumb %}
            {% endif %}

            {% assign default_video_folder = "/video/" %}

            {% if media_video != "" %}

              {% assign video_src = media_video %}
              {% assign first_char = video_src | slice: 0, 1 %}

              {% if video_src contains "://" %}
                {%- comment -%} absolute URL - use as is {%- endcomment -%}
              {% elsif first_char == "/" %}
                {%- comment -%} site-root path - respect baseurl via relative_url {%- endcomment -%}
                {% assign video_src = video_src | relative_url %}
              {% else %}
                {%- comment -%} filename only - prefix with /video/ and respect baseurl {%- endcomment -%}
                {% assign video_src = default_video_folder | append: video_src | relative_url %}
              {% endif %}

              <video class="img-responsive img-centered portfolio-video"
                     controls
                     playsinline
                     preload="metadata">
                <source src="{{ video_src }}" type="video/mp4">
                Your browser does not support the video tag.
              </video>

            {% else %}

              {% if post.img %}
                <img src="{{ '/img/portfolio/' | append: post.img | relative_url }}"
                     class="img-responsive img-centered"
                     alt="{{ post.alt }}">
              {% endif %}

            {% endif %}

            {% if post.description %}
              <p class="portfolio-modal-description">{{ post.description }}</p>
            {% endif %}

            <ul class="list-inline item-details">
              {% if post.client %}
                <li>Company:
                  <strong>{{ post.client }}</strong>
                </li>
              {% endif %}

              {% if post.role %}
                <li>Role:
                  <strong>{{ post.role }}</strong>
                </li>
              {% endif %}

              {% if post.platforms %}
                <li>Platforms:
                  <strong>{{ post.platforms }}</strong>
                </li>
              {% endif %}

              {% if post.engine %}
                <li>Engine:
                  <strong>{{ post.engine }}</strong>
                </li>
              {% endif %}
            </ul>

            <button type="button" class="btn btn-default" data-dismiss="modal">
              <i class="fa fa-times"></i> Close
            </button>

          </div>
        </div>
      </div>
    </div>

  </div>
</div>
{% endfor %}